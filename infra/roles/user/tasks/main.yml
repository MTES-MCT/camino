---
- name: ajoute le groupe "git"
  ansible.builtin.group:
    name: git
    state: present
    # Le GID doit être le même que dans le Dockerfile.api
    gid: "{{ git_user_gid }}"
  become: True
- name: ajoute le groupe "docker"
  ansible.builtin.group:
    name: docker
    state: present
  become: True
- name: ajoute l'utilisateur 'git'
  ansible.builtin.user:
    name: git
    comment: Git
    shell: "/bin/bash"
    # L'UID doit être le même que dans le Dockerfile.api
    uid: "{{ git_user_uid }}"
    groups: git, users, docker
  become: True
- name: Ajout utilisateurs
  include_tasks: "devs.yml"
  loop: "{{ users }}"
  loop_control:
    loop_var: camino_dev
- file:
    path: /srv/www/camino/files
    group: users
    state: directory
    recurse: True
    owner: git
    mode: u=rwx,g=rwx,o=r
  become: True
- name: supprime l'utilisateur debian
  ansible.builtin.user:
    name: debian
    state: absent
    remove: True
    force: True
  become: True
