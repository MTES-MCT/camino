@startuml
hide circle
skinparam linetype ortho

entity "**activites_documents**" {
  + ""id"": //character varying(255) [PK]//
  --
  *""activite_document_type_id"": //character varying(3) //
  *""date"": //character varying(10) //
  ""activite_id"": //character varying(255) [FK]//
  ""description"": //character varying(1024) //
  *""largeobject_id"": //oid //
}

entity "**activites_types**" {
  + ""id"": //character varying(3) [PK]//
  --
  *""nom"": //character varying(255) //
  *""frequence_id"": //character varying(3) //
  *""date_debut"": //character varying(255) //
  ""delai_mois"": //integer //
  *""ordre"": //integer //
  ""description"": //text //
}

entity "**administrations**" {
  + ""id"": //character varying(64) [PK]//
  --
}

entity "**administrations__activites_types__emails**" {
  + ""activite_type_id"": //character varying(3) [PK][FK]//
  + ""administration_id"": //character varying(64) [PK][FK]//
  + ""email"": //character varying(255) [PK]//
  --
}

entity "**caches**" {
  + ""id"": //character varying(128) [PK]//
  --
  ""valeur"": //jsonb //
}

entity "**communes**" {
  + ""id"": //character varying(5) [PK]//
  --
  *""nom"": //character varying(255) //
}

entity "**communes_postgis**" {
  + ""id"": //character varying(5) [PK]//
  --
  ""geometry"": //geometry(MultiPolygon,4326) //
}

entity "**demarches_types**" {
  + ""id"": //character varying(3) [PK]//
  --
  *""nom"": //character varying(255) //
  ""description"": //text //
  ""ordre"": //integer //
  ""duree"": //boolean //
  ""points"": //boolean //
  ""substances"": //boolean //
  ""titulaires"": //boolean //
  ""renouvelable"": //boolean //
  ""exception"": //boolean //
  ""auto"": //boolean //
  ""travaux"": //boolean //
}

entity "**documents**" {
  + ""id"": //character varying(255) [PK]//
  --
  *""type_id"": //character varying(3) [FK]//
  *""date"": //character varying(10) //
  ""titre_etape_id"": //character varying(128) [FK]//
  *""description"": //character varying(1024) //
  ""fichier"": //boolean //
  ""fichier_type_id"": //character varying(3) //
  *""public_lecture"": //boolean //
  *""entreprises_lecture"": //boolean //
}

entity "**documents_types**" {
  + ""id"": //character varying(3) [PK]//
  --
  *""nom"": //character varying(255) //
  ""description"": //text //
}

entity "**domaines**" {
  + ""id"": //character varying(1) [PK]//
  --
  *""nom"": //character varying(255) //
  ""description"": //text //
  *""ordre"": //integer //
}

entity "**entreprises**" {
  + ""id"": //character varying(64) [PK]//
  --
  *""nom"": //character varying(255) //
  ""pays_id"": //character varying(255) //
  ""legal_siren"": //character varying(255) //
  ""legal_etranger"": //character varying(255) //
  ""legal_forme"": //character varying(255) //
  ""categorie"": //character varying(255) //
  ""date_creation"": //character varying(10) //
  ""adresse"": //character varying(255) //
  ""code_postal"": //character varying(255) //
  ""commune"": //character varying(255) //
  ""cedex"": //character varying(255) //
  ""url"": //character varying(1024) //
  ""email"": //character varying(255) //
  ""telephone"": //character varying(255) //
  ""archive"": //boolean //
}

entity "**entreprises_documents**" {
  + ""id"": //character varying(255) [PK]//
  --
  *""entreprise_document_type_id"": //character varying(3) //
  *""date"": //character varying(10) //
  ""entreprise_id"": //character varying(64) [FK]//
  ""description"": //character varying(1024) //
  *""largeobject_id"": //oid //
}

entity "**entreprises_etablissements**" {
  + ""id"": //character varying(64) [PK]//
  --
  *""entreprise_id"": //character varying(64) [FK]//
  ""nom"": //character varying(255) //
  ""legal_siret"": //character varying(255) //
  ""date_debut"": //character varying(10) //
  ""date_fin"": //character varying(10) //
}

entity "**etapes_types**" {
  + ""id"": //character varying(3) [PK]//
  --
  ""nom"": //character varying(128) //
  ""description"": //text //
  *""ordre"": //integer //
  ""fondamentale"": //boolean //
  ""unique"": //boolean //
  ""acceptation_auto"": //boolean //
  ""date_fin"": //character varying(10) //
  ""public_lecture"": //boolean //
  ""entreprises_lecture"": //boolean //
}

entity "**forets_postgis**" {
  + ""id"": //character varying(30) [PK]//
  --
  ""geometry"": //geometry(MultiPolygon,4326) //
}

entity "**journaux**" {
  + ""id"": //character varying(255) [PK]//
  --
  *""utilisateur_id"": //character varying(255) //
  *""date"": //timestamp with time zone //
  *""element_id"": //character varying(255) //
  *""operation"": //text //
  ""differences"": //jsonb //
  *""titre_id"": //character varying(128) [FK]//
}

entity "**knex_migrations**" {
  + ""id"": //serial [PK]//
  --
  ""name"": //character varying(255) //
  ""batch"": //integer //
  ""migration_time"": //timestamp with time zone //
}

entity "**knex_migrations_lock**" {
  + ""index"": //serial [PK]//
  --
  ""is_locked"": //integer //
}

entity "**sdom_zones_postgis**" {
  + ""id"": //character varying(30) [PK]//
  --
  ""geometry"": //geometry(MultiPolygon,4326) //
}

entity "**secteurs_maritime_postgis**" {
  + ""id"": //integer [PK]//
  --
  ""geometry"": //geometry(MultiPolygon,4326) //
}

entity "**spatial_ref_sys**" {
  + ""srid"": //integer [PK]//
  --
  ""auth_name"": //character varying(256) //
  ""auth_srid"": //integer //
  ""srtext"": //character varying(2048) //
  ""proj4text"": //character varying(2048) //
}

entity "**titres**" {
  + ""id"": //character varying(128) [PK]//
  --
  *""nom"": //character varying(255) //
  *""type_id"": //character varying(3) [FK]//
  *""titre_statut_id"": //character varying(3) //
  *""public_lecture"": //boolean //
  *""entreprises_lecture"": //boolean //
  ""doublon_titre_id"": //character varying(128) //
  ""contenus_titre_etapes_ids"": //jsonb //
  ""coordonnees"": //point //
  ""props_titre_etapes_ids"": //jsonb //
  *""slug"": //character varying(255) //
  *""archive"": //boolean //
  *""references"": //jsonb //
}

entity "**titres__titres**" {
  + ""titre_from_id"": //character varying(255) [PK][FK]//
  + ""titre_to_id"": //character varying(255) [PK][FK]//
  --
}

entity "**titres_activites**" {
  + ""id"": //character varying(255) [PK]//
  --
  ""titre_id"": //character varying(128) [FK]//
  ""utilisateur_id"": //character varying(128) [FK]//
  *""date"": //character varying(10) //
  ""date_saisie"": //character varying(10) //
  ""contenu"": //jsonb //
  *""type_id"": //character varying(3) [FK]//
  *""activite_statut_id"": //character varying(3) //
  *""annee"": //integer //
  *""periode_id"": //integer //
  *""sections"": //jsonb[] //
  *""suppression"": //boolean //
  *""slug"": //character varying(255) //
}

entity "**titres_amodiataires**" {
  + ""titre_etape_id"": //character varying(128) [PK][FK]//
  + ""entreprise_id"": //character varying(64) [PK][FK]//
  --
  ""operateur"": //boolean //
}

entity "**titres_demarches**" {
  + ""id"": //character varying(128) [PK]//
  --
  *""titre_id"": //character varying(128) [FK]//
  *""type_id"": //character varying(3) [FK]//
  *""statut_id"": //character varying(3) //
  *""public_lecture"": //boolean //
  *""entreprises_lecture"": //boolean //
  ""ordre"": //integer //
  ""slug"": //character varying(255) //
  ""description"": //character varying(255) //
  *""archive"": //boolean //
  ""demarche_date_debut"": //character varying(10) //
  ""demarche_date_fin"": //character varying(10) //
}

entity "**titres_etapes**" {
  + ""id"": //character varying(128) [PK]//
  --
  *""titre_demarche_id"": //character varying(128) [FK]//
  *""type_id"": //character varying(3) [FK]//
  *""statut_id"": //character varying(3) //
  *""ordre"": //integer //
  *""date"": //character varying(10) //
  ""date_debut"": //character varying(10) //
  ""date_fin"": //character varying(10) //
  ""duree"": //integer //
  ""surface"": //real //
  ""contenu"": //jsonb //
  ""incertitudes"": //jsonb //
  ""heritage_props"": //jsonb //
  ""heritage_contenu"": //jsonb //
  ""slug"": //character varying(255) //
  ""decisions_annexes_sections"": //jsonb[] //
  ""decisions_annexes_contenu"": //json //
  *""archive"": //boolean //
  *""substances"": //jsonb //
  ""secteurs_maritime"": //jsonb //
  ""administrations_locales"": //jsonb //
  ""sdom_zones"": //jsonb //
  *""forets"": //jsonb //
  *""communes"": //jsonb //
}

entity "**titres_etapes_entreprises_documents**" {
  + ""titre_etape_id"": //character varying(128) [PK][FK]//
  + ""entreprise_document_id"": //character varying(255) [PK][FK]//
  --
}

entity "**titres_points**" {
  + ""id"": //character varying(255) [PK]//
  --
  *""titre_etape_id"": //character varying(128) [FK]//
  *""coordonnees"": //point //
  *""groupe"": //integer //
  *""contour"": //integer //
  *""point"": //integer //
  ""nom"": //character varying(255) //
  ""description"": //text //
  ""subsidiaire"": //boolean //
  ""lot"": //integer //
  ""slug"": //character varying(255) //
}

entity "**titres_points_references**" {
  + ""id"": //character varying(255) [PK]//
  --
  ""titre_point_id"": //character varying(255) [FK]//
  *""geo_systeme_id"": //character varying(5) //
  *""coordonnees"": //point //
  ""opposable"": //boolean //
  ""slug"": //character varying(255) //
}

entity "**titres_titulaires**" {
  + ""titre_etape_id"": //character varying(128) [PK][FK]//
  + ""entreprise_id"": //character varying(64) [PK][FK]//
  --
  ""operateur"": //boolean //
}

entity "**titres_types**" {
  + ""id"": //character varying(3) [PK]//
  --
  *""domaine_id"": //character varying(1) [FK]//
  *""type_id"": //character varying(3) [FK]//
  ""contenu_ids"": //jsonb[] //
  ""archive"": //boolean //
}

entity "**titres_types_types**" {
  + ""id"": //character varying(2) [PK]//
  --
  *""nom"": //character varying(255) //
  ""description"": //text //
  *""ordre"": //integer //
}

entity "**utilisateurs**" {
  + ""id"": //character varying(255) [PK]//
  --
  ""email"": //character varying(255) //
  ""nom"": //character varying(255) //
  ""prenom"": //character varying(255) //
  ""telephone_fixe"": //character varying(255) //
  ""telephone_mobile"": //character varying(255) //
  *""role"": //character varying(255) //
  *""date_creation"": //character varying(255) //
  ""administration_id"": //character varying(255) [FK]//
  ""qgis_token"": //character varying(255) //
  ""keycloak_id"": //character varying(255) //
}

entity "**utilisateurs__entreprises**" {
  --
  ""utilisateur_id"": //character varying(64) [FK]//
  ""entreprise_id"": //character varying(64) [FK]//
}

entity "**utilisateurs__titres**" {
  + ""utilisateur_id"": //character varying(255) [PK][FK]//
  + ""titre_id"": //character varying(255) [PK][FK]//
  --
}

"**activites_documents**"   }--  "**titres_activites**"

"**administrations__activites_types__emails**"   }--  "**activites_types**"

"**administrations__activites_types__emails**"   }--  "**activites_types**"

"**administrations__activites_types__emails**"   }--  "**administrations**"

"**administrations__activites_types__emails**"   }--  "**administrations**"

"**documents**"   }--  "**titres_etapes**"

"**documents**"   }--  "**documents_types**"

"**entreprises_documents**"   }--  "**entreprises**"

"**entreprises_etablissements**"   }--  "**entreprises**"

"**journaux**"   }--  "**titres**"

"**titres**"   }--  "**titres_types**"

"**titres__titres**"   }--  "**titres**"

"**titres__titres**"   }--  "**titres**"

"**titres__titres**"   }--  "**titres**"

"**titres__titres**"   }--  "**titres**"

"**titres_activites**"   }--  "**titres**"

"**titres_activites**"   }--  "**activites_types**"

"**titres_activites**"   }--  "**utilisateurs**"

"**titres_amodiataires**"   }--  "**entreprises**"

"**titres_amodiataires**"   }--  "**entreprises**"

"**titres_amodiataires**"   }--  "**titres_etapes**"

"**titres_amodiataires**"   }--  "**titres_etapes**"

"**titres_demarches**"   }--  "**titres**"

"**titres_demarches**"   }--  "**demarches_types**"

"**titres_etapes**"   }--  "**titres_demarches**"

"**titres_etapes**"   }--  "**etapes_types**"

"**titres_etapes_entreprises_documents**"   }--  "**entreprises_documents**"

"**titres_etapes_entreprises_documents**"   }--  "**entreprises_documents**"

"**titres_etapes_entreprises_documents**"   }--  "**titres_etapes**"

"**titres_etapes_entreprises_documents**"   }--  "**titres_etapes**"

"**titres_points**"   }--  "**titres_etapes**"

"**titres_points_references**"   }--  "**titres_points**"

"**titres_titulaires**"   }--  "**entreprises**"

"**titres_titulaires**"   }--  "**entreprises**"

"**titres_titulaires**"   }--  "**titres_etapes**"

"**titres_titulaires**"   }--  "**titres_etapes**"

"**titres_types**"   }--  "**domaines**"

"**titres_types**"   }--  "**domaines**"

"**titres_types**"   }--  "**titres_types_types**"

"**titres_types**"   }--  "**titres_types_types**"

"**utilisateurs**"   }--  "**administrations**"

"**utilisateurs__entreprises**"   }--  "**entreprises**"

"**utilisateurs__entreprises**"   }--  "**utilisateurs**"

"**utilisateurs__titres**"   }--  "**titres**"

"**utilisateurs__titres**"   }--  "**titres**"

"**utilisateurs__titres**"   }--  "**utilisateurs**"

"**utilisateurs__titres**"   }--  "**utilisateurs**"
@enduml
