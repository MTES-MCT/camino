@startuml
!include <tupadr3/common>

!include <office/Databases/database>
!include <office/Servers/application_server>
!include <office/Concepts/application_web>
!include <office/Devices/device_laptop>
!include <office/Servers/3rd_party_mail_server>

OFF_DEVICE_LAPTOP(Utilisateurs, Utilisateurs)

package Externes {
  OFF_APPLICATION_SERVER(Sentry, Sentry)
  OFF_3RD_PARTY_MAIL_SERVER(Mailjet, Mailjet)
  Sentry -[hidden]d-> Mailjet
}
package Gouvernement {
  OFF_APPLICATION_SERVER(Matomo, Matomo)
  OFF_APPLICATION_SERVER(Cerbere, Cerbere)
  OFF_APPLICATION_SERVER(Insee, Insee)
  OFF_APPLICATION_SERVER(Administrations, Administrations)

  Matomo -[hidden]d->Cerbere
  Cerbere -[hidden]d->Insee
  Insee -[hidden]d->Administrations
}

package Camino {
  OFF_APPLICATION_WEB(UI, Interface)
  OFF_APPLICATION_SERVER(API,Serveur)
  OFF_DATABASE(Postgres,Postgres)

  OFF_APPLICATION_SERVER(CRON,Cron)
  OFF_APPLICATION_SERVER(GeoApi,GeoApi)
  UI --> API
  Postgres -[hidden]d-> CRON
}


Utilisateurs --> UI

API --> Postgres
API --> GeoApi
API -> Cerbere
API -> Insee
API -> Matomo: statistiques
UI -> Sentry: erreurs
CRON -> Administrations
CRON -> Insee
API -> Sentry: erreurs
API -> Mailjet: envoie mail
Matomo <- UI: statistiques
@enduml
